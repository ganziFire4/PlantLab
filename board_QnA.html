<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>플랜트랩_커뮤니티</title>
    <link rel="icon" type="img/png" href="image/round_logo_whiteBack.svg">
    <link rel="stylesheet" href="css/nav_header_footer.css">
    <link rel="stylesheet" href="css/board_QnA.css">
    <script src="js/jquery-3.7.1.min.js"></script>
    <!--bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>
<body class="noto-sans-kr">
    <nav>
        <div class="nav_left">
            <div>
                <a href="mainpage01.html">
                    <img src="image/nav_logo.svg" alt="플랜트랩 로고">
                </a>
            </div>
            <div>
                <ul class="nav_menu">
                    <li><a href="board_list.html">커뮤니티</a></li>
                    <li><a href="#">스토어</a></li>
                    <div id="weather">
                      <li style="display: flex;">
                          <img id="weatherImg" src="#" alt="날씨 이미지">
                          <img id="weatherLine" src="image/weatherLine.svg" alt="라인 이미지">
                          <p id="result"></p>
                      </li>
                    </div>
                </ul>
            </div>
        </div>
        <div class="nav_right">
            <div class="nav_search">
                <span>
                    <svg width="25" height="25.5" viewBox="0 0 30 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M28.9749 26.5226L23.9072 20.9181L20.0092 19.137C21.3071 17.0958 22.0025 14.6606 22 12.1652C22 5.45727 17.0654 0 11 0C4.93455 0 0 5.45727 0 12.1652C0 18.8731 4.93455 24.3304 11 24.3304C13.276 24.3333 15.4961 23.551 17.3511 22.0925L18.9574 26.3918L24.0249 31.9966C24.3499 32.3561 24.7358 32.6412 25.1604 32.8357C25.5851 33.0303 26.0402 33.1304 26.4998 33.1304C26.9595 33.1305 27.4146 33.0303 27.8393 32.8358C28.2639 32.6413 28.6498 32.3562 28.9748 31.9968C29.2998 31.6374 29.5576 31.2106 29.7335 30.741C29.9094 30.2714 30 29.7681 30 29.2597C30 28.7514 29.9095 28.2481 29.7336 27.7784C29.5577 27.3088 29.2999 26.8821 28.9749 26.5226ZM2 12.1652C2 6.67703 6.03749 2.21185 11 2.21185C15.9625 2.21185 20 6.67703 20 12.1652C20 17.6534 15.9625 22.1185 11 22.1185C6.03749 22.1185 2 17.6534 2 12.1652ZM27.5606 30.4326C27.2791 30.7433 26.8976 30.9177 26.4999 30.9177C26.1022 30.9177 25.7208 30.7433 25.4393 30.4326L20.6535 25.1399L19.1601 21.1424L22.7749 22.7939L27.5607 28.0866C27.8416 28.398 27.9993 28.8198 27.9993 29.2596C27.9993 29.6994 27.8415 30.1213 27.5606 30.4326Z" fill="#878787"/>
                        </svg>                    
                </span>
                <input type="text" id="search" placeholder="통합검색">
            </div>
            <script>
              const nickname = sessionStorage.getItem("login");
              if(nickname === null){
                  document.write(`
                  <div class="member">
                      <ul>
                          <li><a href="_01_login01.html">로그인</a></li>
                          |
                          <li><a href="_02_join01.html">회원가입</a></li>
                      </ul>
                  </div>
                  `);
              } else {
                  document.write(`
                  <div class="member">
                      <ul>
                          <li style="margin:0;">
                              <a href="#">
                                  <img src="image/profile_empty.svg" alt="임시 프로필사진" width="40px" height="40px">
                              </a>
                          </li>
                          <li style="margin-left: 10px; font-size: 1.1rem">
                              <a href="#" style="font-weight:400">${nickname}</a>
                          </li>
                      </ul>
                  </div>
                  `);
              }
          </script>
        </div>
    </nav>
    <header id="header">
        <img src="image/header_질문.png" alt="질문게시판 헤더">
    </header>
    <main>
      <div class="wrapper">
        <!--게시판 이동-->
        <div class="board_button_area">
          <ul>
            <li class="label_underline">
              <label for="info">
                <input type="checkbox" id="info">
                <span>정보공유</span>
              </label>
            </li>
            <li class="label_underline">
              <label for="free">
                <input type="checkbox" id="free">
                <span>잡담</span>
              </label>
            </li>
            <li class="label_underline activeBlock">
              <label for="QnA">
                <input type="checkbox" id="QnA">
                <span>Q&A</span>
              </label>
            </li>
            <li class="label_underline">
              <label for="greenTalk">
                <input type="checkbox" id="greenTalk">
                <span>그린톡</span>
              </label>
            </li>
          </ul>
        </div>

        <div class="QnA_container"> 
          <h5>Q.산세베리아 잘 키우는 법</h5>
            <div class="userInfo">
              <img src="image/profile.svg" alt="profile_photo" style="width:40px;">
              <p style="margin-bottom:0;">winter4403</p><p style="margin-bottom:0;">24.07.01</p>
              <img src="image/heart_empty.svg" alt="heart" onclick="toggleHeart(this)">
              <img src="image/bookmark_empty.svg" alt="bookmark" onclick="toggleBookmark(this)">
            </div>
            <div class="q-contents">
              <p>국민의 모든 자유와 권리는 국가안전보장·질서유지 또는 공공복리를 위하여 필요한 경우에 한하여
              법률로써 제한할 수 있으며, 제한하는 경우에도 자유와 권리의 본질적인 내용을 침해할 수 없다.
              대통령은 법률이 정하는 바에 의하여 사면·감형 또는 복권을 명할 수 있다. 모든 국민은 양심의 자유를
              가진다. 지방자치단체는 주민의 복리에 관한 사무를 처리하고 재산을 관리하며, 법령의 범위안에서 자치에
              관한 규정을 제정할 수 있다. 모든 국민은 근로의 의무를 진다. 국가는 근로의 의무의 내용과 조건을
              민주주의원칙에 따라 법률로 정한다. 제3항의 승인을 얻지 못한 때에는 그 처분 또는 명령은 그때부터
              효력을 상실한다. 이 경우 그 명령에 의하여 개정 또는 폐지되었던 법률은 그 명령이 승인을 얻지 못한
              때부터 당연히 효력을 회복한다.
              국민의 모든 자유와 권리는 국가안전보장·질서유지 또는 공공복리를 위하여 필요한 경우에 한하여
              법률로써 제한할 수 있으며, 제한하는 경우에도 자유와 권리의 본질적인 내용을 침해할 수 없다.
              대통령은 법률이 정하는 바에 의하여 사면·감형 또는 복권을 명할 수 있다. 모든 국민은 양심의 자유를
              가진다. 지방자치단체는 주민의 복리에 관한 사무를 처리하고 재산을 관리하며, 법령의 범위안에서 자치에
              관한 규정을 제정할 수 있다. 모든 국민은 근로의 의무를 진다. 국가는 근로의 의무의 내용과 조건을
              민주주의원칙에 따라 법률로 정한다. 제3항의 승인을 얻지 못한 때에는 그 처분 또는 명령은 그때부터
              효력을 상실한다. 이 경우 그 명령에 의하여 개정 또는 폐지되었던 법률은 그 명령이 승인을 얻지 못한
              때부터 당연히 효력을 회복한다.ㅁㅁ머ㅓㅏ럼ㄴ아ㅣ러미ㅏㅇ널마언리ㅏㅓㄴㅁㄹ이ㅓㅁ나이럼나리ㅓ마ㅣㅇㄴ러마ㅣㅓㅇ리ㅏ머라ㅣㅇㄴ머리ㅏㅓㅁ이라ㅓ미안러미ㅏㅇ러ㅣㅏ머라ㅣㅁ어리ㅏㅇ머랴ㅣㄷ러배더개뱓적배ㅑㅓㅐ갸벋쟈ㅐ거ㅐ걉ㅈㄷ더개뱌ㅜㅈ대거ㅜ밷구뱌ㅐㄷㄱ뱆댜구배ㅑㄷ구배ㅑㅈㄷ구배ㅑ주갸ㅐㅂㅈ두개ㅑ붇거ㅏㅜㄴㅁ라ㅓ문아ㅓㅝㅣ망러미ㅏㅇ루미ㅏㅇ넒아니러마ㅣㅇ러ㅏㅣ멍ㄴ리ㅏㅓㅁ이ㅏ러미ㅏㅇ러미ㅏㄴ어리ㅏ멍ㄴ리ㅏㅓ미ㅏ어ㅏㅣ럼ㄴ아럼ㅇㄴ러ㅚ아ㅓ</p>
              
            </div>
            <div class="comments">
                <h5>댓글</h5>
                <div class="comment-list" id="comment-list">
                    <!-- Comments will appear here -->
                </div>
                <div class="comment-input">
                    <div class="input-container">
                    <textarea type="text" id="comment-input" placeholder="댓글을 입력하세요"></textarea>
                    <button onclick="addComment()">댓글 쓰기</button>
                  </div>
                </div>
                <hr>
                <div id="button">
                  <a href="board_list.html?tab=3">목록</a>
                </div>
              </div>
              <script>
                // 이미지 클릭 시 변환
                function toggleHeart(heartImg) {
                // 이미지 경로를 가져옴
                var src = heartImg.getAttribute('src');
                
                // 이미지 경로에 따라 상태를 토글
                if (src === 'image/heart_empty.svg') {
                    heartImg.src = 'image/heart_green.svg';
                } else {
                    heartImg.src = 'image/heart_empty.svg';
                }
            }


                // 이미지 클릭 시 변환
                function toggleBookmark(bookmarkImg) {
                // 이미지 경로를 가져옴
                var src = bookmarkImg.getAttribute('src');
                
                // 이미지 경로에 따라 상태를 토글
                if (src === 'image/bookmark_empty.svg') {
                  bookmarkImg.src = 'image/bookmark_green.svg';
                } else {
                  bookmarkImg.src = 'image/bookmark_empty.svg';
                }
            }

              function addComment() {
                // 댓글 입력 필드와 댓글 리스트 요소를 가져옴
              const commentInput = document.getElementById('comment-input');
              const commentList = document.getElementById('comment-list');
              // 로그인된 사용자 이름과 프로필 이미지 URL을 데이터 속성에서 가져옴
              const loggedInUser = document.body.getAttribute('data-logged-in-user');
              const profileImage = document.body.getAttribute('data-profile-image');

          // 댓글 입력 필드가 비어 있지 않은 경우에만 실행
            if (commentInput.value.trim() !== '') {
                // 새로운 댓글을 담을 div 요소 생성
                const newComment = document.createElement('div');
                newComment.classList.add('comment');

                // 작성자와 날짜를 담을 div 요소 생성
                const authorDate = document.createElement('div');
                authorDate.classList.add('author-date');
                
                // 프로필 이미지를 담을 img 요소 생성
                const profileImg = document.createElement('img');
                profileImg.src = "image/profile.svg";
                profileImg.alt = 'profile_photo';
                profileImg.classList.add('profile-image');  // CSS 클래스 추가 가능

                // 현재 날짜와 시간을 가져옴
                const now = new Date();
                // 날짜를 "YYYY.MM.DD" 형식으로 포맷팅
                const formattedDate = `${now.getFullYear()}.${(now.getMonth() + 1).toString().padStart(2, '0')}.${now.getDate().toString().padStart(2, '0')}`;
                // 시간을 "HH:MM:SS" 형식으로 포맷팅
                const formattedTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;

                // 작성자 정보를 담을 span 요소 생성
                const authorSpan = document.createElement('span');
                authorSpan.classList.add('author');
                authorSpan.textContent = loggedInUser;

                // 날짜와 시간을 담을 span 요소 생성
                const dateSpan = document.createElement('span');
                dateSpan.classList.add('date');
                dateSpan.innerHTML = `${formattedDate} <span class="time">${formattedTime}</span>`;

                // 작성자 정보 앞에 프로필 이미지 추가
                authorDate.appendChild(profileImg);
                authorDate.appendChild(authorSpan);
                authorDate.appendChild(dateSpan);

                // 댓글 내용을 담을 div 요소 생성
                const commentText = document.createElement('div');
                commentText.innerHTML = commentInput.value.replace(/\n/g, '<br>');  // 줄바꿈을 <br>로 변환하여 설정
            

                // 작성자 및 날짜 div와 댓글 내용 div를 새 댓글 div에 추가
                newComment.appendChild(authorDate);
                newComment.appendChild(commentText);

                // 새 댓글 div를 댓글 리스트에 추가
                commentList.appendChild(newComment);

                // 댓글 입력 필드를 비움
                commentInput.value = '';
                commentInput.style.height = '42px'; // 입력 완료 후 textarea 크기 초기화
                commentInput.classList.remove('expanded'); // 입력이 완료되면 크기 원래대로 설정
              }
            }

              // 입력 창 내용이 변경될 때 마다 크기 조절
            const commentInput = document.getElementById('comment-input');
            commentInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });

            // 포커스가 되었을 때 크기 증가
            commentInput.addEventListener('focus', function() {
                this.classList.add('expanded');
            });

            // 포커스가 빠졌을 때 크기 되돌리기
            commentInput.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.classList.remove('expanded');
                }
            });
              </script>
            </div>
          </div>
      </div>
    </main>
    <div id="popup-icon1">
      <img src="image/챗봇아이콘.png" alt="Popup Icon" id="popup-image" style="width: 60px; height: 60px;">
    </div>
    <div id="popup-content1" class="hidden">
      <p>안녕하세요! 플랜트 봇 입니다!<br>궁금한 것은 모두 플랜트 봇에게 물어보세요!</p>
    </div>
    <div id="popup-icon2">
      <img src="image/top아이콘.png" alt="Popup Icon" id="popup-image" style="width: 60px; height: 60px;">
    </div>
    <footer>
      <div class="f_container">
          <div style="margin: auto 50px;">
              <img width="150px" height="150px" src="image/round_logo_colorBack.svg" alt="플랜트팜 로고">
          </div>
          <div>
              <p>주소 :  서울특별시 강남구 강남대로2689길 20, 5층(역삼동)   TEL : 02 - 1111-2222</p>
              <p>상호명 : (주)플랜트랩</p>
              <p>Copyright © 2024 .All RIGHTS RSERVED.</p>
              <p>불4조 :  정다은  김화영  김시표  송주헌  반재형</p>
          </div>
      </div>
    </footer>
    <script>
      const now = new Date();
      let nowMonth = now.getMonth()+1;
      let zeroMonth = '0' + nowMonth;
      let zeroDate = '0' + now.getDate();
      let year = now.getFullYear();
      let month = zeroMonth.substr(-2);
      let date = zeroDate.substr(-2);
      let url = `https://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getVilageFcst?serviceKey=gIQrlKBkoGwsDw%2BrhZZZ47LwsVb%2BsbXkagAhe20dhc5nBBIQUxXsw7PB38hiMm8JNRN%2FnVI23Kv6glqRx3C94Q%3D%3D&pageNo=1&numOfRows=1000&dataType=JSON&base_date=${year}${month}${date}&base_time=0500&nx=61&ny=126`;
      
      let temperature;
      let rain;
      let quantity;
      let tempNum = 0; // 온도
      let rainNum = 9; // 강수량
      let quantityNum = 7; // 강수확률

      let hour = now.getHours();
      const index = [];
      $.getJSON(url, function(data) {
          temperature = data.response.body.items.item[tempNum].fcstValue;
          rain = data.response.body.items.item[rainNum].fcstValue;
          quantity = data.response.body.items.item[quantityNum].fcstValue;
          // console.log(url);
          // $('#result').text(`기온 : ${temperature}˚ 강수량 : ${rain}mm`);
          if(quantity <= 10) {
              // 맑음 
              $('#weatherImg').attr('src', 'image/sunny.svg');
              $('#result').html(`<div>${temperature} ˚C<br>맑음</div>`);
          } else if(quantity < 50){
              // 흐림
              $('#weatherImg').attr('src', "image/rainny.svg");
              $('#result').html(`<div>${temperature} ˚C<br>흐림</div>`);
          } else {
              // 비
              $('#weatherImg').attr('src', "image/strongRainny.svg");
              $('#result').html(`<div>${temperature} ˚C<br> 비(${rain})</div>`);
          }
      });
      
      document.addEventListener('DOMContentLoaded', () => {
          const popupIcon = document.getElementById('popup-icon1');
          const popupContent = document.getElementById('popup-content1');
          const popupIcon2 = document.getElementById('popup-icon2');

          popupIcon.addEventListener('mouseover', () => {
              popupContent.classList.remove('hidden');
          });

          popupIcon.addEventListener('mouseleave', () => {
              popupContent.classList.add('hidden');
          });

          popupIcon2.addEventListener('click', () => {
          window.scrollTo({ top: 0, behavior: 'smooth' });
          });
      });    
  </script>
</body>
</html>